{"remainingRequest":"C:\\Users\\86152\\Desktop\\casual\\iview-admin\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\86152\\Desktop\\casual\\iview-admin\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\Users\\86152\\Desktop\\casual\\iview-admin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\86152\\Desktop\\casual\\iview-admin\\src\\view\\components\\org-tree\\components\\org-view.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\86152\\Desktop\\casual\\iview-admin\\src\\view\\components\\org-tree\\components\\org-view.vue","mtime":1575545426906},{"path":"C:\\Users\\86152\\Desktop\\casual\\iview-admin\\.babelrc","mtime":1575545426802},{"path":"C:\\Users\\86152\\Desktop\\casual\\iview-admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\86152\\Desktop\\casual\\iview-admin\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\86152\\Desktop\\casual\\iview-admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\86152\\Desktop\\casual\\iview-admin\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.number.constructor\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { on, off } from '@/libs/tools';\nvar menuList = [{\n  key: 'edit',\n  label: '编辑部门'\n}, {\n  key: 'detail',\n  label: '查看部门'\n}, {\n  key: 'new',\n  label: '新增子部门'\n}, {\n  key: 'delete',\n  label: '删除部门'\n}];\nexport default {\n  name: 'OrgView',\n  props: {\n    zoomHandled: {\n      type: Number,\n      default: 1\n    },\n    data: Object\n  },\n  data: function data() {\n    return {\n      currentContextMenuId: '',\n      orgTreeOffsetLeft: 0,\n      orgTreeOffsetTop: 0,\n      initPageX: 0,\n      initPageY: 0,\n      oldMarginLeft: 0,\n      oldMarginTop: 0,\n      canMove: false\n    };\n  },\n  computed: {\n    orgTreeStyle: function orgTreeStyle() {\n      return {\n        transform: \"translate(-50%, -50%) scale(\".concat(this.zoomHandled, \", \").concat(this.zoomHandled, \")\"),\n        marginLeft: \"\".concat(this.orgTreeOffsetLeft, \"px\"),\n        marginTop: \"\".concat(this.orgTreeOffsetTop, \"px\")\n      };\n    }\n  },\n  methods: {\n    handleNodeClick: function handleNodeClick(e, data, expand) {\n      expand();\n    },\n    closeMenu: function closeMenu() {\n      this.currentContextMenuId = '';\n    },\n    getBgColor: function getBgColor(data) {\n      return this.currentContextMenuId === data.id ? data.isRoot ? '#0d7fe8' : '#5d6c7b' : '';\n    },\n    nodeRender: function nodeRender(h, data) {\n      return h(\"div\", {\n        \"class\": ['custom-org-node', data.children && data.children.length ? 'has-children-label' : ''],\n        \"on\": {\n          \"mousedown\": function mousedown(event) {\n            return event.stopPropagation();\n          },\n          \"contextmenu\": this.contextmenu.bind(this, data)\n        }\n      }, [data.label, h(\"dropdown\", {\n        \"attrs\": {\n          \"trigger\": \"custom\",\n          \"visible\": this.currentContextMenuId === data.id\n        },\n        \"class\": \"context-menu\",\n        \"nativeOn\": {\n          \"click\": this.handleDropdownClick\n        },\n        \"on\": {\n          \"on-click\": this.handleContextMenuClick.bind(this, data)\n        },\n        \"style\": {\n          transform: \"scale(\".concat(1 / this.zoomHandled, \", \").concat(1 / this.zoomHandled, \")\")\n        },\n        \"directives\": [{\n          name: \"click-outside\",\n          value: this.closeMenu\n        }]\n      }, [h(\"dropdown-menu\", {\n        \"slot\": \"list\"\n      }, [menuList.map(function (item) {\n        return h(\"dropdown-item\", {\n          \"attrs\": {\n            \"name\": item.key\n          }\n        }, [item.label]);\n      })])])]);\n    },\n    contextmenu: function contextmenu(data, $event) {\n      var event = $event || window.event;\n      event.preventDefault ? event.preventDefault() : event.returnValue = false;\n      this.currentContextMenuId = data.id;\n    },\n    setDepartmentData: function setDepartmentData(data) {\n      data.isRoot = true;\n      this.departmentData = data;\n    },\n    mousedownView: function mousedownView(event) {\n      this.canMove = true;\n      this.initPageX = event.pageX;\n      this.initPageY = event.pageY;\n      this.oldMarginLeft = this.orgTreeOffsetLeft;\n      this.oldMarginTop = this.orgTreeOffsetTop;\n      on(document, 'mousemove', this.mousemoveView);\n      on(document, 'mouseup', this.mouseupView);\n    },\n    mousemoveView: function mousemoveView(event) {\n      if (!this.canMove) return;\n      var pageX = event.pageX,\n          pageY = event.pageY;\n      this.orgTreeOffsetLeft = this.oldMarginLeft + pageX - this.initPageX;\n      this.orgTreeOffsetTop = this.oldMarginTop + pageY - this.initPageY;\n    },\n    mouseupView: function mouseupView() {\n      this.canMove = false;\n      off(document, 'mousemove', this.mousemoveView);\n      off(document, 'mouseup', this.mouseupView);\n    },\n    handleDropdownClick: function handleDropdownClick(event) {\n      event.stopPropagation();\n    },\n    handleDocumentContextmenu: function handleDocumentContextmenu() {\n      this.canMove = false;\n    },\n    handleContextMenuClick: function handleContextMenuClick(data, key) {\n      this.$emit('on-menu-click', {\n        data: data,\n        key: key\n      });\n    }\n  },\n  mounted: function mounted() {\n    on(document, 'contextmenu', this.handleDocumentContextmenu);\n  },\n  beforeDestroy: function beforeDestroy() {\n    off(document, 'contextmenu', this.handleDocumentContextmenu);\n  }\n};",{"version":3,"sources":["org-view.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n  <div\r\n    ref=\"dragWrapper\"\r\n    class=\"org-tree-drag-wrapper\"\r\n    @mousedown=\"mousedownView\"\r\n    @contextmenu=\"handleDocumentContextmenu\"\r\n  >\r\n    <div class=\"org-tree-wrapper\" :style=\"orgTreeStyle\">\r\n      <v-org-tree\r\n        v-if=\"data\"\r\n        :data=\"data\"\r\n        :node-render=\"nodeRender\"\r\n        :expand-all=\"true\"\r\n        @on-node-click=\"handleNodeClick\"\r\n        collapsable\r\n      ></v-org-tree>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { on, off } from '@/libs/tools'\r\nconst menuList = [\r\n  {\r\n    key: 'edit',\r\n    label: '编辑部门'\r\n  },\r\n  {\r\n    key: 'detail',\r\n    label: '查看部门'\r\n  },\r\n  {\r\n    key: 'new',\r\n    label: '新增子部门'\r\n  },\r\n  {\r\n    key: 'delete',\r\n    label: '删除部门'\r\n  }\r\n]\r\nexport default {\r\n  name: 'OrgView',\r\n  props: {\r\n    zoomHandled: {\r\n      type: Number,\r\n      default: 1\r\n    },\r\n    data: Object\r\n  },\r\n  data () {\r\n    return {\r\n      currentContextMenuId: '',\r\n      orgTreeOffsetLeft: 0,\r\n      orgTreeOffsetTop: 0,\r\n      initPageX: 0,\r\n      initPageY: 0,\r\n      oldMarginLeft: 0,\r\n      oldMarginTop: 0,\r\n      canMove: false\r\n    }\r\n  },\r\n  computed: {\r\n    orgTreeStyle () {\r\n      return {\r\n        transform: `translate(-50%, -50%) scale(${this.zoomHandled}, ${\r\n          this.zoomHandled\r\n        })`,\r\n        marginLeft: `${this.orgTreeOffsetLeft}px`,\r\n        marginTop: `${this.orgTreeOffsetTop}px`\r\n      }\r\n    }\r\n  },\r\n  methods: {\r\n    handleNodeClick (e, data, expand) {\r\n      expand()\r\n    },\r\n    closeMenu () {\r\n      this.currentContextMenuId = ''\r\n    },\r\n    getBgColor (data) {\r\n      return this.currentContextMenuId === data.id\r\n        ? data.isRoot\r\n          ? '#0d7fe8'\r\n          : '#5d6c7b'\r\n        : ''\r\n    },\r\n    nodeRender (h, data) {\r\n      return (\r\n        <div\r\n          class={[\r\n            'custom-org-node',\r\n            data.children && data.children.length ? 'has-children-label' : ''\r\n          ]}\r\n          on-mousedown={event => event.stopPropagation()}\r\n          on-contextmenu={this.contextmenu.bind(this, data)}\r\n        >\r\n          {data.label}\r\n          <dropdown\r\n            trigger=\"custom\"\r\n            class=\"context-menu\"\r\n            visible={this.currentContextMenuId === data.id}\r\n            nativeOn-click={this.handleDropdownClick}\r\n            on-on-click={this.handleContextMenuClick.bind(this, data)}\r\n            style={{\r\n              transform: `scale(${1 / this.zoomHandled}, ${1 /\r\n                this.zoomHandled})`\r\n            }}\r\n            v-click-outside={this.closeMenu}\r\n          >\r\n            <dropdown-menu slot=\"list\">\r\n              {menuList.map(item => {\r\n                return (\r\n                  <dropdown-item name={item.key}>{item.label}</dropdown-item>\r\n                )\r\n              })}\r\n            </dropdown-menu>\r\n          </dropdown>\r\n        </div>\r\n      )\r\n    },\r\n    contextmenu (data, $event) {\r\n      let event = $event || window.event\r\n      event.preventDefault\r\n        ? event.preventDefault()\r\n        : (event.returnValue = false)\r\n      this.currentContextMenuId = data.id\r\n    },\r\n    setDepartmentData (data) {\r\n      data.isRoot = true\r\n      this.departmentData = data\r\n    },\r\n    mousedownView (event) {\r\n      this.canMove = true\r\n      this.initPageX = event.pageX\r\n      this.initPageY = event.pageY\r\n      this.oldMarginLeft = this.orgTreeOffsetLeft\r\n      this.oldMarginTop = this.orgTreeOffsetTop\r\n      on(document, 'mousemove', this.mousemoveView)\r\n      on(document, 'mouseup', this.mouseupView)\r\n    },\r\n    mousemoveView (event) {\r\n      if (!this.canMove) return\r\n      const { pageX, pageY } = event\r\n      this.orgTreeOffsetLeft = this.oldMarginLeft + pageX - this.initPageX\r\n      this.orgTreeOffsetTop = this.oldMarginTop + pageY - this.initPageY\r\n    },\r\n    mouseupView () {\r\n      this.canMove = false\r\n      off(document, 'mousemove', this.mousemoveView)\r\n      off(document, 'mouseup', this.mouseupView)\r\n    },\r\n    handleDropdownClick (event) {\r\n      event.stopPropagation()\r\n    },\r\n    handleDocumentContextmenu () {\r\n      this.canMove = false\r\n    },\r\n    handleContextMenuClick (data, key) {\r\n      this.$emit('on-menu-click', { data, key })\r\n    }\r\n  },\r\n  mounted () {\r\n    on(document, 'contextmenu', this.handleDocumentContextmenu)\r\n  },\r\n  beforeDestroy () {\r\n    off(document, 'contextmenu', this.handleDocumentContextmenu)\r\n  }\r\n}\r\n</script>\r\n\r\n<style>\r\n</style>\r\n"],"sourceRoot":"src/view/components/org-tree/components"}]}